<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="layout.html" />
  <xi:include href="macros.html" />
  <head>
    <title>Repository Index</title>
  </head>

  <body>
    <div id="content" class="browser">

      <h1>Repository Index</h1>

      <table class="listing" id="dirlist">
        <thead>
          <tr>
            <th class="name">Name</th>
            <th class="rev">Rev</th>
            <th class="date">Age</th>
            <th class="change">Last Change</th>
          </tr>
        </thead>
        <tbody>
          <py:for each="idx, (reponame, repos, repoinfo, change) in enumerate(repositories)">
            <tr class="${idx % 2 and 'even' or 'odd'}">
              <td class="name">
                <a class="dir" title="View Root Directory"
                    href="${href.browser(reponame, order=(order != 'name' and order or None), desc=desc)}" py:choose="reponame"><b py:when="''">(default)</b><py:otherwise>$reponame</py:otherwise></a>
              </td>
              <td class="rev">
                <a title="View Revision Log" href="${href.log(reponame)}">$change.rev</a>
              </td>
              <td class="age" style="${change and timerange and 'border-color: rgb(%s,%s,%s)' %
                colorize_age(timerange.relative(change.date)) or None}">
                ${change and dateinfo(change.date) or '-'}
              </td>
              <td class="change">
                <span class="author" py:if="change">${authorinfo(change.author)}:</span>
                <span class="change" py:choose="" py:with="chgset_context = context('changeset', (reponame, change.rev))">
                  <py:when test="not change or 'CHANGESET_VIEW' not in perm(chgset_context.resource)">-</py:when>
                  <py:when test="wiki_format_messages">
                    ${change and wiki_to_oneliner(chgset_context, change.message, shorten=True)}
                  </py:when>
                  <py:otherwise>${change and shorten_line(change.message)}</py:otherwise>
                </span>
              </td>
            </tr>
            <tr class="${idx % 2 and 'even' or 'odd'}" py:if="repoinfo.description">
              <td class="description" colspan="4">$repoinfo.description</td>
            </tr>
          </py:for>
        </tbody>
      </table>

      <div id="help">
        <strong>Note:</strong> See <a href="${href.wiki('TracBrowser')}">TracBrowser</a>
        for help on using the browser.
      </div>

    </div>
  </body>
</html>
